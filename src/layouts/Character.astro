---
// BlogPost.astro (レイアウト)
const { frontmatter } = Astro.props;
const { title, face, tags } = frontmatter;

import CharacterCard from "../components/char/CharacterCard.astro";

let charInfo = {
    rank: null,
    element: null,
    class: null,
    principle: null,
}

const classMap = {
    "戦術": "/class/trickster.jpg",
    "突撃": "/class/fighter.jpg",
    "支援": "/class/supporter.jpg",
    "強襲": "/class/slayer.jpg",
    "制圧": "/class/breaker.jpg"
}

const elementMap = {
    "火": "/element/fire.jpg",
    "水": "/element/water.jpg",
    "雷": "/element/thunder.jpg",
    "風": "/element/wind.jpg",
    "地": '/element/ground.jpg'
}

//'ランク:SSR', '属性:水', 'クラス:戦術', '信念:友情'
if(tags && tags.length > 0) {
    tags.forEach((tag: any) => {
        if(tag.includes(":")) {
            const [key, value] = tag.split(":").map((s:string) => s.trim());
            switch(key) {
                case "ランク":
                    charInfo.rank = value;
                    break;
                case "属性":
                    charInfo.element = elementMap[value] ?? '';
                    break;
                case "クラス":
                    charInfo.class = classMap[value] ?? '';
                    break;
                case "信念":
                    charInfo.principle = value;
                    break;
            }
        }
    })
}
console.log(charInfo);
---

<html>
<head>
    <title>{title}</title>
</head>
<body>
<article>
    <div class="flex flex-row gap-5">
        <div>
            {face && <img src={face} alt="騎士画像" />}
        </div>
        <div class="flex justify-center items-center">
            <table>
                <tr>
                    <td>ランク:</td>
                    <td class="content-center">{charInfo.rank || "不明"}</td>
                    <td>属性:</td>
                    <td class="content-center">{charInfo.element ? <img src={charInfo.element} alt="属性アイコン" width="24" height="24" /> : "不明"}</td>
                </tr>
                <tr>
                    <td>クラス:</td>
                    <td class="content-center">{charInfo.class ? <img src={charInfo.class} alt="クラスアイコン" width="24" height="24" /> : "不明"}</td>
                    <td>信念:</td>
                    <td class="content-center">{charInfo.principle || "不明"}</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="content">
        <slot />
    </div>
</article>
</body>
</html>

<style>
    .hero-image {
        width: 100%;
        height: 400px;
        object-fit: cover;
        margin-bottom: 2rem;
    }

    .tags-container {
        margin: 1rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .tags-label {
        font-weight: bold;
        color: #666;
    }

    .tags {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .tag {
        background: #e1f5fe;
        color: #0277bd;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.875rem;
        border: 1px solid #b3e5fc;
    }

    .tag:hover {
        background: #b3e5fc;
        transform: translateY(-1px);
        transition: all 0.2s ease;
    }

    .content {
        margin-top: 2rem;
    }
</style>